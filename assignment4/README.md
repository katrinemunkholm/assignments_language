
# Assignment 4 - Emotion Analysis with Pretrained Language Models

## Description

This repository contains a script for analyzing the emotional expressions in dialogues from the television show "Game of Thrones" using pretrained language models from HuggingFace. The analysis aims to explore how the emotional profile of the show changed over its eight seasons.

## Task Overview

The key tasks performed by the scripts in this repository are:
1. Predict emotion scores for all lines in the data using a pretrained emotion classifier.
2. For each season, plot the distribution of all emotion labels.
3. For each emotion label, plot the relative frequency of each emotion across all seasons.


## Data Source

The data is available for download [here.](https://www.kaggle.com/datasets/albenft/game-of-thrones-script-all-seasons?select=Game_of_Thrones_Script.csv) 

The dataset contains the following information: `release date` (release of the episode), `season` (season number), `episode` (episode number), `episode title` (title of the episode), `name` (name of character speaking), `sentence` (actual spoken sentence).


## Setup and Running the Analysis

### Requirements

- Python 3
- Libraries: 
`matplotlib==3.8.4`
`numpy==1.26.4`
`pandas==2.2.2`
`transformers==4.40.1`
`codecarbon==2.3.`
`torch==1.13.1`



### Environment Setup and Execution

1. **Environment Setup**:
To set up a virtual environment and install the required packages, run the following in the command line:
```bash
bash setup.sh
```

2. **Running the Script**:
```bash
bash run.sh
```

## Output

After running the script, the following outputs are generated: 

- Pie charts for each season showing the distribution of emotions.
- A pie chart showing the relative frequency of each emotion throughout all seasons.
- The charts are saved in the `out` directory under the appropriate filenames indicating the type of analysis.


## Example Output

- `Season 1_emotion_distribution.png`: Shows the emotional distribution in Season 1.
- `relative_frequency_emotions.png`: Shows the relative frequencies of emotions across all seasons.


## Results and interpretation

Upon reviewing the plots for each season's emotion distribution, it appears that the distributions remain fairly consistent across the series. A significant majority of the lines, representing 48.1%, are categorized as 'neutral'. Other notable emotions identified in the analysis include surprise and anger. It’s crucial to note that these labels reflect the emotions expressed in the dialogues by the characters and should not be directly equated to the viewers’ emotional reactions. For example, although 11.5% of lines are labeled as "surprise," this does not necessarily indicate the presence or absence of surprising elements in the show, nor does it suggest that the intensity of surprise remains constant across different seasons.

In summary, while the emotional distribution does not show substantial variation, I am cautious about drawing any definitive conclusions regarding the overall emotional trajectory of the series based on this data alone.

## Discussion of Limitations and Possible Steps to Improvement

### Limitations

The primary limitation of this analysis stems from the potential misalignment between the emotion labels generated by the model and the actual emotional context intended by the "Game of Thrones" narrative. While a significant proportion of dialogues are labeled as 'neutral', this may not accurately reflect the emotional intensity or subtlety of the scenes. The labeling of lines as "surprise" or "anger" also does not necessarily correlate with the viewers' perception or the narrative intent, possibly leading to misinterpretations of the emotional dynamics within the series. This discrepancy highlights the challenge of using automated tools to analyze complex human emotions conveyed through media.

### Possible Steps to Improvement

To enhance the accuracy and relevance of the emotional analysis:
- **Model Fine-Tuning:** Fine-tune the pretrained model on a dataset more closely aligned with the narrative style and emotional depth of "Game of Thrones" to better capture the nuances of the dialogues.
- **Contextual Analysis:** Integrate additional contextual analysis techniques that consider the surrounding narrative elements, such as plot developments and character interactions, to provide a more comprehensive understanding of the emotional landscape.
- **Viewer Feedback Integration:** Incorporate feedback or emotional responses from viewers to validate and refine the emotion predictions, ensuring they resonate more accurately with human interpretations.


## File Structure

The downloaded folder should be placed in the "data" folder. The scripts assume the following structure of the repository:
```
assignment4/
│
├── in/
│   └── Game_of_Thrones_Script.csv
│
├── out/
│   ├── relative_frequency_emotions.png
│   ├── Season 1_emotion_distribution.png
│   ├── Season 2_emotion_distribution.png
│   └── ...
│
├── src/
│   └── script.py
│
├── README.md
├── requirements.txt
├── run.sh
└── setup.sh
```
